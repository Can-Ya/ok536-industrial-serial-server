# 工业串口服务器
## 功能
**简介**：基于飞凌OK536开发板的工业级项目，核心是发挥OK536的17路UART硬件优势，区别于普通的单路串口转以太网简易工具，是一款融合Linux 底层驱动开发、高并发I/O编程、工业协议栈开发、网络通信、系统可靠性设计、嵌入式产品化工程能力的综合性嵌入式 Linux 开发项目。
项目的核心本质是：打造一台工业级的串口-以太网数据枢纽，打通传统工业串口设备（传感器、PLC、仪表、控制器）与以太网 / 上位机 / 云端平台的通信壁垒，实现多路串口数据的并发采集、智能协议转换、高可靠网络转发，同时具备完整的配置、监控、故障自愈能力，完全对标工业现场量产的串口服务器 / 数据终端单元 (DTU)。

## 开发流程
1. 基础框架搭建与数据通路验证:
   1. 查阅OK536硬件手册、底板原理图、.dtsi、官方手册，确认17路ART 的设备节点（如/dev/ttySA1~/dev/ttySA17）。
   2. 编写双路串口回环测试程序，将UART7收到的数据直接转发至UART8，反之亦然，验证串口驱动与硬件正常工作。
   3. 编写基础的Socket TCP Server程序，实现读取指定串口UART7、UART8的所有数据，原样发送给所有连接的TCP客户端，完成首个端到端的数据通路。
2. 多路并发采集与核心业务逻辑实现
   1. 使用epoll（推荐，效率更高）或 pthread 多线程重构程序，实现同时监听、采集、处理任意路数串口的并发数据，替代单路串口的轮询方式
   2. 设计串口参数结构体数组，编写配置文件解析代码，实现从 JSON/YAML 配置文件读取每路串口的参数，支持动态修改
   3. 编写Modbus RTU 帧解析状态机，从串口字节流中精准提取完整的 Modbus RTU 帧（从站地址→功能码→数据→CRC 校验），解决「粘包、半包、帧错误」问题，优先实现 03/06 核心功能码
   4. 实现 Modbus-RTU ↔ Modbus-TCP 的双向转换，将解析后的 RTU 帧封装为 TCP 格式报文转发，将 TCP 报文解包为 RTU 帧发往串口
3. 系统健壮性建设与基础管理功能
   1. 为 TCP Client 模式实现断线自动重连 + 心跳保活机制，为 TCP Server 实现无效连接清理，杜绝网络异常导致的程序卡死
   2. 实现分级日志功能，将系统启动、串口状态、网络连接、数据异常等事件记录到本地文件，便于问题定位与排查
   3. 使用getopt/readline库编写交互式命令行工具，支持通过 SSH 登录开发板，实现串口状态查询、参数动态修改、网络配置调整
   4. 长时间（24h+）大数据量运行测试，使用top/valgrind工具排查内存泄漏、CPU 占用过高问题，优化程序性能
4. 高级功能开发 + 产品化落地 + 成果整理
   1. 开发嵌入式 Web 图形化管理界面（求职展示利器）：使用轻量级 C 语言库（mongoose）或 BoA+CGI 搭建 Web 服务，实现浏览器可视化配置串口参数、切换协议模式、查看串口状态与数据流量，界面无需复杂，简洁实用即可，面试时现场演示此功能，冲击力极强
   2. 实现守护进程 + 看门狗机制：将主程序改造为 Linux 守护进程，脱离终端后台运行；编写简易看门狗脚本，监控进程状态，异常崩溃时自动重启，体现工业级设计思维。推荐：性能优化：尝试使用 Linux「零拷贝」技术（如splice系统调用）优化串口→网络的数据搬运过程，减少 CPU 占用，提升数据转发效率
   3. 项目文档整理 + 演示素材录制：编写完整的 README 文档（含项目功能、编译方法、配置示例、使用说明），录制简短的功能演示视频（演示串口数据采集、协议转换、Web 配置、断网重连），整理核心代码注释
